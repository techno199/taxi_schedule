(this.webpackJsonptaxi_schedule=this.webpackJsonptaxi_schedule||[]).push([[0],{106:function(e,t,n){},107:function(e,t,n){},120:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(33),c=n.n(r),o=(n(106),n(5)),s=(n(107),n(20)),d=n(152),l=n(172),u=n(19),j=n(43),b=Object(j.c)({name:"editDailyScheduleModal",initialState:{open:!1},reducers:{setEditDailyScheduleModalSliceState:function(e,t){return Object(u.a)(Object(u.a)({},e),t.payload)}}}),h=b.actions.setEditDailyScheduleModalSliceState,v=b.reducer,f=n(61),O=n(167),m=n(168),x=n(173),p=n(174),g=n(175),C=n(176),S=n(164),y=n(169),D=n(177),I=n(178),k=n(4),w=Object(d.a)((function(e){return{formControl:{"&:not(:last-child)":{marginBottom:12}}}}));function N(e){var t=e.date,n=e.selectedDriverId,a=void 0===n?null:n,i=e.driverOptions,r=e.selectedStatusId,c=void 0===r?null:r,o=e.statusOptions,s=e.onDriverChange,d=e.onStatusChange,l=Object(f.a)(e,["date","selectedDriverId","driverOptions","selectedStatusId","statusOptions","onDriverChange","onStatusChange"]),j=w(),b=function(e){return function(t){switch(e){case"driver":s&&s(t.target.value);break;case"status":d&&d(t.target.value)}}};return Object(k.jsxs)(O.a,Object(u.a)(Object(u.a)({},l),{},{children:[Object(k.jsxs)(m.a,{children:["\u041d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f \u043d\u0430 ",Object(k.jsx)("u",{children:t.format("LL")})]}),Object(k.jsx)(x.a,{children:Object(k.jsxs)(p.a,{children:[Object(k.jsxs)(g.a,{className:j.formControl,children:[Object(k.jsx)(C.a,{children:"\u0412\u043e\u0434\u0438\u0442\u0435\u043b\u044c"}),Object(k.jsx)(S.a,{value:a,onChange:b("driver"),children:i&&i.map((function(e){return Object(k.jsx)(y.a,{value:e.id,children:e.name},e.id)}))})]}),Object(k.jsxs)(g.a,{children:[Object(k.jsx)(C.a,{children:"\u0421\u0442\u0430\u0442\u0443\u0441"}),Object(k.jsx)(S.a,{value:c,onChange:b("status"),children:o&&o.map((function(e){return Object(k.jsx)(y.a,{value:e.id,children:e.name},e.id)}))})]})]})}),Object(k.jsxs)(D.a,{children:[Object(k.jsx)(I.a,{variant:"contained",color:"primary",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),Object(k.jsx)(I.a,{onClick:function(){return l.onClose&&l.onClose({},"backdropClick")},children:"\u041d\u0430\u0437\u0430\u0434"})]})]}))}var M=n(16),T=n.n(M);var L=function(e){var t=Object(s.b)(),n=Object(s.c)((function(e){return e})),a=n.editDailyScheduleModal,i=n.schedule;return Object(k.jsx)(N,Object(u.a)({date:T()(a.selectedDate),selectedDriverId:a.selectedDriverId,selectedStatusId:a.selectedStatusId,driverOptions:i.drivers,statusOptions:i.statuses,open:a.open,onDriverChange:function(e){t(h({selectedDriverId:e}))},onStatusChange:function(e){t(h({selectedStatusId:e}))},onClose:function(){t(h({open:!1}))}},e))},z=n(179),R=n(180),W=n(181),A=n(157),B=n(170),F=n(182),E=n(183),P=n(171),V=n(158),Y=n(184),J=n(59),_=n.n(J),q=Object(d.a)((function(e){return{root:{height:"100%",display:"flex",cursor:"pointer",backgroundColor:function(e){var t;return"".concat(null===(t=e.status)||void 0===t?void 0:t.color," !important")}},wrapper:{display:"flex",flex:1,flexFlow:"column",transition:"background-color .2s ease !important",backgroundColor:"".concat(e.palette.grey[300]," !important"),"&:hover":{backgroundColor:"".concat(e.palette.grey[500]," !important"),"& .driver":{background:e.palette.grey[300]}}},driverNameRow:{height:32,"&:not(:last-child)":{borderBottom:"1px solid ".concat(e.palette.grey[400])},display:"flex",justifyContent:"center",alignItems:"center"},selectedText:{padding:"0 4px",borderRadius:4,fontWeight:500,transition:"all .2s ease",background:e.palette.grey[500],whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",maxWidth:70},status:{width:10,height:"100%"}}}));function G(e){var t=e.driver,n=e.status,a=e.isMainDriver,i=void 0===a||a,r=Object(f.a)(e,["driver","status","isMainDriver"]),c=q(e);return Object(k.jsx)(l.a,Object(u.a)(Object(u.a)({className:c.root},r),{},{children:Object(k.jsxs)("div",{className:c.wrapper,children:[Object(k.jsx)("div",{className:c.driverNameRow,children:i&&Object(k.jsx)("span",{className:_()(c.selectedText,"driver"),children:null===t||void 0===t?void 0:t.name})}),Object(k.jsx)("div",{className:c.driverNameRow,children:!i&&Object(k.jsx)("span",{className:_()(c.selectedText,"driver"),children:null===t||void 0===t?void 0:t.name})}),Object(k.jsx)("div",{className:c.driverNameRow,children:Object(k.jsx)("span",{className:c.selectedText,style:{background:null===n||void 0===n?void 0:n.color},children:null===n||void 0===n?void 0:n.name})})]})}))}var H=n(159),K=Object(d.a)((function(e){return{root:{padding:"20px 0",marginLeft:function(e){return e.vehicleNameCellWidth},position:"relative","& .MuiTableCell-root":{borderBottom:"none"}},tableRoot:{tableLayout:"fixed"},headerCell:{textAlign:"center",fontSize:"inherit",whiteSpace:"nowrap",width:function(e){return"calc(100% / ".concat(e.renderDaysCount,")")}},cell:{height:114,boxSizing:"border-box",padding:8,position:"relative",fontSize:"inherit"},divider:{borderLeft:"1px solid ".concat(e.palette.grey[500]),"&:before":{content:"attr(data-month)",position:"absolute",top:-12,fontWeight:500,textTransform:"capitalize"}},vehicleNameCell:{position:"absolute",width:function(e){return e.vehicleNameCellWidth},height:114,boxSizing:"border-box",padding:8,right:"100%",textAlign:"left"},vehicleNameContainer:{backgroundColor:"".concat(e.palette.grey[300]," !important"),height:"100%",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center"},fab:{position:"absolute",right:e.spacing(2),bottom:e.spacing(2)},skeleton:{transform:"none !important"}}}));function Q(e){for(var t=e.isLoading,n=e.scheduleScheme,a=e.vehicles,i=e.drivers,r=e.statuses,c=e.startDate,s=e.renderDaysCount,d=void 0===s?7:s,u=e.onEditDateClick,j=e.onReturnToTodayClick,b=K(e),h=T()().subtract(2*d,"days"),v=T()().add(d,"days"),f=c.isBefore(h)||c.isAfter(v),O=T()(c).add(d,"days"),m=[],x=T()(c);x.isBefore(O);x.add(1,"day"))m.push(T()(x));return Object(k.jsx)("div",{className:b.root,children:Object(k.jsxs)(z.a,{children:[Object(k.jsxs)(R.a,{className:b.tableRoot,children:[Object(k.jsxs)(W.a,{children:[Object(k.jsx)(A.a,{className:b.vehicleNameCell}),m.map((function(e){return Object(k.jsxs)(A.a,{className:b.headerCell,children:[Object(k.jsxs)("span",{children:[e.format("DD, dd")," "]}),e.isSame(T()(),"day")&&Object(k.jsx)(B.a,{label:"\u0441\u0435\u0433\u043e\u0434\u043d\u044f",size:"small",color:"secondary"})]})}))]}),Object(k.jsx)(F.a,{children:(a||[{id:0,name:""},{id:1,name:""},{id:2,name:""}]).map((function(e,a){return Object(k.jsxs)(E.a,{children:[Object(k.jsxs)("th",{className:b.vehicleNameCell,children:[t&&Object(k.jsx)(P.a,{className:b.skeleton,height:"100%"}),!t&&Object(k.jsx)(l.a,{className:b.vehicleNameContainer,children:e.name})]}),m.map((function(c){var s,d,l,j,h,v=null===n||void 0===n||null===(s=n.find((function(e){return T()(e.date).isSame(c,"day")})))||void 0===s?void 0:s.schedule.find((function(t){return t.vehicleId===e.id})),f=1===c.date(),O=null===i||void 0===i?void 0:i.find((function(e){return e.id===(null===v||void 0===v?void 0:v.driverId)})),m=null===r||void 0===r?void 0:r.find((function(e){return e.id===(null===v||void 0===v?void 0:v.statusId)}));return Object(k.jsxs)(A.a,{"data-month":0===a?c.format("MMMM"):"",className:_()(b.cell,Object(o.a)({},b.divider,f)),children:[t&&Object(k.jsx)(P.a,{className:b.skeleton,height:"100%"}),!t&&Object(k.jsx)(G,{driver:O,status:m,isMainDriver:null===v||void 0===v?void 0:v.isMainDriver,onClick:(d=c,l=e.id,j=null===O||void 0===O?void 0:O.id,h=null===m||void 0===m?void 0:m.id,function(){u&&u(d,l,j,h)})})]})}))]},e.id)}))})]}),Object(k.jsx)(V.a,{in:f,children:Object(k.jsx)(Y.a,{className:b.fab,color:"secondary",style:{position:"absolute"},onClick:j,children:Object(k.jsx)(H.a,{})})})]})})}var U=n(27),X=n(160),Z=n(80),$=n.n(Z),ee=n(91),te={vehicles:[{id:0,name:"Volkswagen Polo"},{id:1,name:"Volkswagen Polo"},{id:2,name:"Volkswagen Passat"}],drivers:[{id:0,name:"Driver 1"},{id:1,name:"Driver 2"}],statuses:[{id:0,name:"\u0412\u044b\u0445\u043e\u0434",color:"#4caf50"},{id:1,name:"\u041f\u0440\u043e\u0441\u0442\u043e\u0439",color:"#f44336"},{id:2,name:"\u0420\u0435\u043c\u043e\u043d\u0442",color:"#ff9800"}],scheduleScheme:[{date:"2021-02-25",schedule:[{driverId:0,vehicleId:0,statusId:0,isMainDriver:Math.random()<.5}]},{date:"2021-02-26",schedule:[{driverId:1,vehicleId:1,statusId:1,isMainDriver:Math.random()<.5}]},{date:"2021-02-27",schedule:[{driverId:1,vehicleId:2,statusId:2,isMainDriver:Math.random()<.5}]},{date:"2021-02-28",schedule:[{driverId:0,vehicleId:0,statusId:0,isMainDriver:Math.random()<.5},{driverId:1,vehicleId:2,statusId:0,isMainDriver:Math.random()<.5}]},{date:"2021-03-1",schedule:[{driverId:1,vehicleId:2,statusId:2,isMainDriver:Math.random()<.5}]}]},ne={selectedDate:T()().toISOString(),isLoading:!1},ae=Object(j.b)("schedule/fetchTableData",function(){var e=Object(ee.a)($.a.mark((function e(t){var n;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){setTimeout((function(){return e(te)}),3e3)}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ie=Object(j.c)({name:"schedule",initialState:ne,reducers:{setScheduleSliceState:function(e,t){return Object(u.a)(Object(u.a)({},e),t.payload)}},extraReducers:function(e){e.addCase(ae.pending,(function(e,t){e.isLoading=!0})),e.addCase(ae.fulfilled,(function(e,t){return Object(u.a)(Object(u.a)(Object(u.a)({},e),t.payload),{},{isLoading:!1})}))}}),re=ie.actions.setScheduleSliceState,ce=ie.reducer;var oe=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.schedule})),n=t.isLoading,a=t.selectedDate,i=t.vehicles,r=t.drivers,c=t.statuses,o=t.scheduleScheme,d=Object(U.a)(),l=7,u=200;return Object(X.a)(d.breakpoints.down("lg"))&&(l=5),Object(X.a)(d.breakpoints.down("md"))&&(l=3,u=150),Object(X.a)(d.breakpoints.down("sm"))&&(l=2,u=100),Object(k.jsx)(Q,{isLoading:n,vehicles:i,drivers:r,statuses:c,scheduleScheme:o,renderDaysCount:l,vehicleNameCellWidth:u,startDate:T()(a),onEditDateClick:function(t,n,a,i){e(h({open:!0,selectedDate:t.toISOString(),selectedVehicleId:n,selectedDriverId:a,selectedStatusId:i}))},onReturnToTodayClick:function(){e(re({selectedDate:T()().toISOString()}))}})},se=n(161),de=n(162),le=n(163),ue=Object(d.a)((function(e){return{root:{display:"flex",justifyContent:"center"}}}));function je(e){var t=ue(),n=e.onArrowClick,a=function(e){return function(){n&&n({direction:e})}};return Object(k.jsx)("div",{className:t.root,children:Object(k.jsxs)(se.a,{display:"flex",justifyContent:"space-between",width:150,children:[Object(k.jsx)(I.a,{variant:"contained",onClick:a("prev"),children:Object(k.jsx)(de.a,{})}),Object(k.jsx)(I.a,{variant:"contained",onClick:a("next"),children:Object(k.jsx)(le.a,{})})]})})}var be=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.schedule.selectedDate}));return Object(k.jsx)(je,{onArrowClick:function(n){var a=T()(t);"prev"===n.direction?a.subtract(1,"day"):a.add(1,"day"),e(re({selectedDate:a.toISOString()}))}})},he=n(92),ve=n.n(he),fe=Object(d.a)((function(e){return{root:{display:"flex",flexWrap:"nowrap",background:e.palette.grey[300],borderRadius:4},dateString:{display:"flex",justifyContent:"center",alignItems:"center",width:120,textAlign:"center",cursor:"default",textTransform:"capitalize",fontWeight:500}}}));function Oe(e){var t=e.date,n=void 0===t?T()():t,a=e.onDateChange,i=fe(),r=function(e){return function(){var t;t="prev"===e?T()(n).subtract(1,"month").set("date",1):T()(n).add(1,"month").set("date",1),a&&a(t)}};return Object(k.jsxs)("div",{className:i.root,children:[Object(k.jsx)(I.a,{onClick:r("prev"),children:Object(k.jsx)(de.a,{})}),Object(k.jsx)(ve.a,{className:i.dateString,date:n,format:"MMMM, YYYY"}),Object(k.jsx)(I.a,{onClick:r("next"),children:Object(k.jsx)(le.a,{})})]})}var me=Object(d.a)((function(e){return{root:Object(o.a)({display:"flex",alignItems:"center"},e.breakpoints.down("sm"),{flexFlow:"column"}),title:Object(o.a)({fontSize:20,fontWeight:600,marginRight:10},e.breakpoints.down("md"),{fontSize:14}),button:{fontSize:"inherit !important"},selector:Object(o.a)({marginLeft:"auto"},e.breakpoints.down("sm"),{marginLeft:"unset",marginTop:32})}}));function xe(e){var t=me(),n=e.date,a=e.onDateChange;return Object(k.jsxs)("div",{className:t.root,children:[Object(k.jsxs)("div",{children:[Object(k.jsx)("span",{className:t.title,children:"\u041a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c \u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0439"}),Object(k.jsx)(I.a,{className:t.button,variant:"contained",color:"secondary",children:"\u0421\u043f\u0438\u0441\u0430\u0442\u044c \u0430\u0440\u0435\u043d\u0434\u0443"})]}),Object(k.jsx)("div",{className:t.selector,children:Object(k.jsx)(Oe,{date:n,onDateChange:a})})]})}var pe=function(){var e=Object(s.b)(),t=Object(s.c)((function(e){return e.schedule.selectedDate}));return Object(k.jsx)(xe,{date:T()(t),onDateChange:function(t){e(re({selectedDate:t.toISOString()}))}})},ge=Object(d.a)((function(e){return{root:{display:"flex",flex:1,flexFlow:"column",padding:20,maxWidth:"100%",boxSizing:"border-box"}}}));function Ce(){var e=ge();return Object(k.jsxs)(l.a,{elevation:3,className:e.root,children:[Object(k.jsx)(pe,{}),Object(k.jsx)(oe,{}),Object(k.jsx)(be,{}),Object(k.jsx)(L,{fullWidth:!0})]})}var Se=function(){var e=Object(s.b)();return Object(a.useEffect)((function(){e(ae({startDate:T()(),endDate:T()()}))}),[]),Object(k.jsx)(Ce,{})},ye=Object(d.a)((function(e){return{root:Object(o.a)({display:"flex",width:"100%",boxSizing:"border-box",padding:20,maxWidth:1200},e.breakpoints.down("md"),{fontSize:12})}}));var De=function(){var e=ye();return Object(k.jsx)("div",{className:e.root,children:Object(k.jsx)(Se,{})})},Ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,185)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),a(e),i(e),r(e),c(e)}))},ke=(n(119),n(31)),we=Object(ke.c)({schedule:ce,editDailyScheduleModal:v}),Ne=Object(j.a)({reducer:we});c.a.render(Object(k.jsx)(i.a.StrictMode,{children:Object(k.jsx)(s.a,{store:Ne,children:Object(k.jsx)(De,{})})}),document.getElementById("root")),Ie()}},[[120,1,2]]]);
//# sourceMappingURL=main.a1e92902.chunk.js.map